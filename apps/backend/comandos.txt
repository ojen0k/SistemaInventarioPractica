1.- Correr apps
Correr back: /apps/backend
pnpm start:dev

Correr Front: /apps/frontend
pnpm dev


2.- Instalar dependencias:

Para instalar usando pnpm se debe tenemos primero pnpm:
pnpm install


****/apps/backend:

Dependencias de morgan y logger:
pnpm add morgan
pnpm add -D @types/morgan

Dependencias de AuthModule(jwt):
pnpm add @nestjs/jwt passport passport-jwt bcrypt
pnpm add -D @types/passport-jwt @types/bcrypt

Passport:
pnpm add @nestjs/passport passport passport-jwt
pnpm add -D @types/passport-jwt


Class-validator:
pnpm add class-validator class-transformer



***/apps/frontend:
pnpm build


3.- Generar cliente y validar:

pnpm dlx prisma validate (valida que el schema sea correcto)
pnpm dlx prisma generate (genera el cliente)


Subir a la base de datos con push:

pnpm dlx prisma db push (sincroniza el schema con la base de datos)
pnpm dlx prisma generate (genera el cliente)


Formatear el schema: (identacion, orden, estilo)

pnpm dlx prisma format


orden de comandos:

1.- pnpm dlx prisma format
2.- pnpm dlx prisma validate
3.- pnpm dlx prisma db push
4.- pnpm dlx prisma generate



4.- Para agregar areas y estados de los catalogos (llamados cat_*nombre* dentro de la BD), se usan los comandos:

pnpm seed:areas (agrega areas y subareas)
pnpm seed:catalogos (agrega estados de los catalogos) 

cada seed tiene su .json y readme para las instrucciones de como usarlo y agregar datos


5.- Bootstrap de admin (si es que está en true el valor del .env):
pnpm bootstrap:admin




6.- Docker (correr en /SistemaInventarioPractica/apps)
***sudo docker compose down && sudo DOCKER_BUILDKIT=1 docker compose build --no-cache && sudo docker compose up --force-recreate -d

sudo: "SuperUser Do". En Ubuntu es obligatorio para tener permisos.

docker compose down: Apaga y destruye los contenedores actuales. Limpia la mesa.

&&: "Si lo anterior funcionó, entonces haz lo siguiente..."

DOCKER_BUILDKIT=1: Activa el modo "Turbo" de Docker para construir más rápido y con características modernas.

build --no-cache: Cocina todo desde cero. Le prohíbe a Docker usar "ingredientes guardados" (caché). Esto es vital si agregaste dependencias en package.json, para forzar que las descargue de nuevo.

up --force-recreate -d: Levanta el sistema.

--force-recreate: "Aunque el contenedor parezca estar bien, destrúyelo y créalo de nuevo por si acaso".

-d (Detached): "Corre en segundo plano". Te devuelve el control de la terminal inmediatamente.





 ***sudo docker compose down && sudo DOCKER_BUILDKIT=1 docker compose build --no-cache --progress=plain && sudo docker compose up --force-recreate -d

--progress=plain: En lugar de mostrarte una barrita de carga bonita que oculta detalles, te muestra todo el texto plano.



***sudo docker compose up -d --build

para correrlo sin borrar nada
-d es para que se libere la terminal
--build es para que se construya la imagen con las actualizaciones



 Querys en SQL Server:

Para ver las areas y subareas:

-- 1) Conteos
SELECT COUNT(*) AS areas FROM dbo.area;
SELECT COUNT(*) AS direcciones FROM dbo.direccion;
SELECT COUNT(*) AS departamentos FROM dbo.departamento;
SELECT COUNT(*) AS oficinas FROM dbo.oficina;
SELECT COUNT(*) AS secciones_programas FROM dbo.seccion_programa;

-- 2) Ver algunos datos
SELECT TOP 20 * FROM dbo.area ORDER BY id_area;
SELECT TOP 20 * FROM dbo.direccion ORDER BY id_direccion;
SELECT TOP 20 * FROM dbo.departamento ORDER BY id_departamento;
SELECT TOP 20 * FROM dbo.oficina ORDER BY id_oficina;
SELECT TOP 20 * FROM dbo.seccion_programa ORDER BY id_seccion_programa;

-- 3) Ver la jerarquía completa (join)
SELECT TOP 200
  a.nombre AS area,
  d.nombre AS direccion,
  dep.nombre AS departamento,
  o.nombre AS oficina,
  sp.nombre AS seccion_programa
FROM dbo.seccion_programa sp
JOIN dbo.oficina o            ON o.id_oficina = sp.id_oficina
JOIN dbo.departamento dep     ON dep.id_departamento = o.id_departamento
JOIN dbo.direccion d          ON d.id_direccion = dep.id_direccion
JOIN dbo.area a               ON a.id_area = d.id_area
ORDER BY a.nombre, d.nombre, dep.nombre, o.nombre, sp.nombre;

